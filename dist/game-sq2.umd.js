
/*
 * @Description: 2048类游戏
 * @version: 0.1.0
 * @Author: liejiayong(809206619@qq.com)
 * @Date: 2021-11-17 11:54:01
 * @github url: https://github.com/liejiayong/game-Sq2
 * @LastEditors: liejiayong(809206619@qq.com)
 * @LastEditTime: 2021-11-20 17:01:29
    -----------------
    |   |   |   |   |
    -----------------
    |   |   |   |   |
    -----------------
    |   |   |   |   |
    -----------------
    |   |   |   |   |
    -----------------
  the square of 2

  arr = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15] => gridHeight * gridWidth - 1
  pos2coord {x: num%gridWidth , y: ~~(num/gridWidth)}
 */
    var Sq2=function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}function n(t){try{return!!t()}catch(t){return!0}}function r(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function o(t){return M(L(t),8,-1)}function i(t){if(null==t)throw P("Can't call method on "+t);return t}function a(t){return k(i(t))}function c(t,e){return arguments.length<2?_(n=h[t])?n:void 0:h[t]&&h[t][e];var n}function T(t){if(_(t))return t;throw q(function(t){try{return z(t)}catch(t){return"Object"}}(t)+" is not a function")}function f(e,n){try{X(h,e,{value:n,configurable:!0,writable:!0})}catch(t){h[e]=n}return n}function O(t){return Y(i(t))}function u(t){return"Symbol("+(void 0===t?"":t)+")_"+J(++U+$,36)}function l(t){return t=function(t,e){if(!C(t)||H(t))return t;var n=null==(n=t[rt])?void 0:T(n);if(n){if(n=v(n,t,e=void 0===e?"default":e),!C(n)||H(n))return n;throw nt("Can't convert object to primitive value")}return function(t,e){var n,r;if("string"===e&&_(n=t.toString)&&!C(r=v(n,t)))return r;if(_(n=t.valueOf)&&!C(r=v(n,t)))return r;if("string"!==e&&_(n=t.toString)&&!C(r=v(n,t)))return r;throw W("Can't convert object to primitive value")}(t,e=void 0===e?"number":e)}(t,"string"),H(t)?t:t+""}function s(t){return it?ot.createElement(t):{}}function d(t){if(C(t))return t;throw st(lt(t)+" is not an object")}var p=function(t){return t&&t.Math==Math&&t},h=p("object"==typeof globalThis&&globalThis)||p("object"==typeof window&&window)||p("object"==typeof self&&self)||p("object"==typeof t&&t)||function(){return this}()||Function("return this")(),g=!n(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),y=Function.prototype.call,v=y.bind?y.bind(y):function(){return y.apply(y,arguments)},m={}.propertyIsEnumerable,b=Object.getOwnPropertyDescriptor,w={f:b&&!m.call({1:2},1)?function(t){t=b(this,t);return!!t&&t.enumerable}:m},S=Function.prototype,j=S.bind,x=S.call,E=j&&j.bind(x),p=j?function(t){return t&&E(x,t)}:function(t){return t&&function(){return x.apply(t,arguments)}},L=p({}.toString),M=p("".slice),F=h.Object,A=p("".split),k=n(function(){return!F("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?A(t,""):F(t)}:F,P=h.TypeError,_=function(t){return"function"==typeof t},C=function(t){return"object"==typeof t?null!==t:_(t)},D=p({}.isPrototypeOf),t=c("navigator","userAgent")||"",m=h.process,S=h.Deno,j=m&&m.versions||S&&S.version,m=j&&j.v8,G=Lt=!((Lt=m?0<(xt=m.split("."))[0]&&xt[0]<4?1:+(xt[0]+xt[1]):Lt)||!t||(xt=t.match(/Edge\/(\d+)/))&&xt[1]<74)&&(xt=t.match(/Chrome\/(\d+)/))?+xt[1]:Lt,N=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol();return!(""+t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&G&&G<41}),R=N&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,I=h.Object,H=R?function(t){return"symbol"==typeof t}:function(t){var e=c("Symbol");return _(e)&&D(e.prototype,I(t))},z=h.String,q=h.TypeError,W=h.TypeError,X=Object.defineProperty,V=h["__core-js_shared__"]||f("__core-js_shared__",{}),S=e(function(t){(t.exports=function(t,e){return V[t]||(V[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})}),Y=h.Object,K=p({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return K(O(t),e)},U=0,$=Math.random(),J=p(1..toString),Q=S("wks"),Z=h.Symbol,tt=Z&&Z.for,et=R?Z:Z&&Z.withoutSetter||u,j=function(t){var e;return B(Q,t)&&(N||"string"==typeof Q[t])||(e="Symbol."+t,N&&B(Z,t)?Q[t]=Z[t]:Q[t]=(R&&tt?tt:et)(e)),Q[t]},nt=h.TypeError,rt=j("toPrimitive"),ot=h.document,it=C(ot)&&C(ot.createElement),ct=!g&&!n(function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}),ut=Object.getOwnPropertyDescriptor,at={f:g?ut:function(t,e){if(t=a(t),e=l(e),ct)try{return ut(t,e)}catch(t){}if(B(t,e))return r(!v(w.f,t,e),t[e])}},lt=h.String,st=h.TypeError,ft=h.TypeError,dt=Object.defineProperty,pt={f:g?dt:function(t,e,n){if(d(t),e=l(e),d(n),ct)try{return dt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw ft("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},ht=g?function(t,e,n){return pt.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t},gt=p(Function.toString);_(V.inspectSource)||(V.inspectSource=function(t){return gt(t)});var yt,vt,mt,bt,wt,St,Tt,Ot,jt=V.inspectSource,m=h.WeakMap,xt=_(m)&&/native code/.test(jt(m)),Et=S("keys"),Lt=function(t){return Et[t]||(Et[t]=u(t))},Mt={},Ft=h.TypeError,m=h.WeakMap;Tt=xt||V.state?(yt=V.state||(V.state=new m),vt=p(yt.get),mt=p(yt.has),bt=p(yt.set),wt=function(t,e){if(mt(yt,t))throw new Ft("Object already initialized");return bt(yt,e.facade=t,e),e},St=function(t){return vt(yt,t)||{}},function(t){return mt(yt,t)}):(Ot=Lt("state"),Mt[Ot]=!0,wt=function(t,e){if(B(t,Ot))throw new Ft("Object already initialized");return ht(e.facade=t,Ot,e),e},St=function(t){return B(t,Ot)?t[Ot]:{}},function(t){return B(t,Ot)});function At(t,e){return(t=Rt(t))<0?It(t+e,0):Ht(t,e)}function kt(t){return 0<(t=t.length)?zt(Rt(t),9007199254740991):0}function Pt(t,e){var n,r=a(t),o=0,i=[];for(n in r)!B(Mt,n)&&B(r,n)&&Wt(i,n);for(;o<e.length;)B(r,n=e[o++])&&(~qt(i,n)||Wt(i,n));return i}var _t={set:wt,get:St,has:Tt,enforce:function(t){return Tt(t)?St(t):wt(t,{})},getterFor:function(n){return function(t){var e;if(!C(t)||(e=St(t)).type!==n)throw Ft("Incompatible receiver, "+n+" required");return e}}},S=Function.prototype,xt=g&&Object.getOwnPropertyDescriptor,m=B(S,"name"),Ct={EXISTS:m,PROPER:m&&!1,CONFIGURABLE:m&&(!g||xt(S,"name").configurable)},Dt=e(function(t){var a=Ct.CONFIGURABLE,e=_t.get,l=_t.enforce,s=(""+String).split("String");(t.exports=function(t,e,n,r){var o=!!r&&!!r.unsafe,i=!!r&&!!r.enumerable,c=!!r&&!!r.noTargetGet,u=r&&void 0!==r.name?r.name:e;_(n)&&("Symbol("===(""+u).slice(0,7)&&(u="["+(""+u).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!B(n,"name")||a&&n.name!==u)&&ht(n,"name",u),(r=l(n)).source||(r.source=s.join("string"==typeof u?u:""))),t!==h?(o?!c&&t[e]&&(i=!0):delete t[e],i?t[e]=n:ht(t,e,n)):i?t[e]=n:f(e,n)})(Function.prototype,"toString",function(){return _(this)&&e(this).source||jt(this)})}),Gt=Math.ceil,Nt=Math.floor,Rt=function(t){t=+t;return t!=t||0==t?0:(0<t?Nt:Gt)(t)},It=Math.max,Ht=Math.min,zt=Math.min,xt=function(u){return function(t,e,n){var r,o=a(t),i=kt(o),c=At(n,i);if(u&&e!=e){for(;c<i;)if((r=o[c++])!=r)return!0}else for(;c<i;c++)if((u||c in o)&&o[c]===e)return u||c||0;return!u&&-1}},qt=(xt(!0),xt(!1)),Wt=p([].push),Xt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Vt=Xt.concat("length","prototype"),Yt={f:Object.getOwnPropertyNames||function(t){return Pt(t,Vt)}},Kt={f:Object.getOwnPropertySymbols},Bt=p([].concat),Ut=c("Reflect","ownKeys")||function(t){var e=Yt.f(d(t)),n=Kt.f;return n?Bt(e,n(t)):e},$t=/#|\.prototype\./,S=function(t,e){t=Qt[Jt(t)];return t==te||t!=Zt&&(_(e)?n(e):!!e)},Jt=S.normalize=function(t){return(""+t).replace($t,".").toLowerCase()},Qt=S.data={},Zt=S.NATIVE="N",te=S.POLYFILL="P",ee=S,ne=at.f,xt=function(t,e){var n,r,o,i,c=t.target,u=t.global,a=t.stat;if(n=u?h:a?h[c]||f(c,{}):(h[c]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(i=ne(n,r))&&i.value:n[r],!ee(u?r:c+(a?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;!function(t,e){for(var n=Ut(e),r=pt.f,o=at.f,i=0;i<n.length;i++){var c=n[i];B(t,c)||r(t,c,o(e,c))}}(o,i)}(t.sham||i&&i.sham)&&ht(o,"sham",!0),Dt(n,r,o,t)}},re=Object.keys||function(t){return Pt(t,Xt)},oe=Object.assign,ie=Object.defineProperty,ce=p([].concat),S=!oe||n(function(){if(g&&1!==oe({b:1},oe(ie({},"a",{enumerable:!0,get:function(){ie(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return 1;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=oe({},t)[n]||"abcdefghijklmnopqrst"!=re(oe({},e)).join("")})?function(t,e){for(var n=O(t),r=arguments.length,o=1,i=Kt.f,c=w.f;o<r;)for(var u,a=k(arguments[o++]),l=i?ce(re(a),i(a)):re(a),s=l.length,f=0;f<s;)u=l[f++],g&&!v(c,a,u)||(n[u]=a[u]);return n}:oe;xt({target:"Object",stat:!0,forced:Object.assign!==S},{assign:S}),xt({target:"Object",stat:!0,forced:!g,sham:!g},{defineProperty:pt.f});var S=Date.prototype,ue=p(S.toString),ae=p(S.getTime);"Invalid Date"!=""+new Date(NaN)&&Dt(S,"toString",function(){var t=ae(this);return t==t?ue(this):"Invalid Date"});var S=Function.prototype,le=S.apply,se=S.call,fe="object"==typeof Reflect&&Reflect.apply||(S.bind?se.bind(le):function(){return se.apply(le,arguments)}),de=p([].slice),pe=h.Function,S=function(o){return function(t,e){var n=2<arguments.length,r=n?de(arguments,2):void 0;return o(n?function(){fe(_(t)?t:pe(t),this,r)}:t,e)}};xt({global:!0,bind:!0,forced:/MSIE .\./.test(t)},{setTimeout:S(h.setTimeout),setInterval:S(h.setInterval)});var he=h.Function,ge=p([].concat),ye=p([].join),ve={};xt({target:"Function",proto:!0},{bind:he.bind||function(e){var n=T(this),t=n.prototype,r=de(arguments,1),o=function(){var t=ge(r,de(arguments));return this instanceof o?function(t,e,n){if(!B(ve,e)){for(var r=[],o=0;o<e;o++)r[o]="a["+o+"]";ve[e]=he("C,a","return new C("+ye(r,",")+")")}return ve[e](t,n)}(n,t.length,t):n.apply(e,t)};return C(t)&&(o.prototype=t),o}});var me=p(p.bind),be=Array.isArray||function(t){return"Array"==o(t)},t={};t[j("toStringTag")]="z";function we(){}function Se(t){if(!_(t))return!1;try{return Fe(we,Me,t),!0}catch(t){return!1}}function Te(t,e){return!be(t=t)||(_e(n=t.constructor)&&(n===De||be(n.prototype))||C(n)&&null===(n=n[Ce]))&&(n=void 0),new(void 0===n?De:n)(0===e?0:e);var n}var Oe,S="[object z]"==""+t,je=j("toStringTag"),xe=h.Object,Ee="Arguments"==o(function(){return arguments}()),Le=S?o:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(t=function(t,e){try{return t[e]}catch(t){}}(e=xe(t),je))?t:Ee?o(e):"Object"==(t=o(e))&&_(e.callee)?"Arguments":t},Me=[],Fe=c("Reflect","construct"),Ae=/^\s*(?:class|function)\b/,ke=p(Ae.exec),Pe=!Ae.exec(we),_e=!Fe||n(function(){var t;return Se(Se.call)||!Se(Object)||!Se(function(){t=!0})||t})?function(t){if(!_(t))return!1;switch(Le(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return Pe||!!ke(Ae,jt(t))}:Se,Ce=j("species"),De=h.Array,Ge=p([].push),t=function(h){var g=1==h,y=2==h,v=3==h,m=4==h,b=6==h,w=7==h,S=5==h||b;return function(t,e,n,r){for(var o,i,c,u,a=O(t),l=k(a),s=(u=n,T(c=e),void 0===u?c:me?me(c,u):function(){return c.apply(u,arguments)}),f=kt(l),d=0,r=r||Te,p=g?r(t,f):y||w?r(t,0):void 0;d<f;d++)if((S||d in l)&&(i=s(o=l[d],d,a),h))if(g)p[d]=i;else if(i)switch(h){case 3:return!0;case 5:return o;case 6:return d;case 2:Ge(p,o)}else switch(h){case 4:return!1;case 7:Ge(p,o)}return b?-1:v||m?m:p}},Ne=[t(0),t(1),t(2),t(3),t(4),t(5),t(6),t(7)][0],Re=(Oe=[].forEach)&&n(function(){Oe.call(null,function(){throw 1},1)})?[].forEach:function(t){return Ne(this,t,1<arguments.length?arguments[1]:void 0)};xt({target:"Array",proto:!0,forced:[].forEach!=Re},{forEach:Re}),S||Dt(Object.prototype,"toString",S?{}.toString:function(){return"[object "+Le(this)+"]"},{unsafe:!0});function Ie(e){if(e&&e.forEach!==Re)try{ht(e,"forEach",Re)}catch(t){e.forEach=Re}}var He,ze={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},S=s("span").classList,S=S&&S.constructor&&S.constructor.prototype,S=S===Object.prototype?void 0:S;for(He in ze)ze[He]&&Ie(h[He]&&h[He].prototype);Ie(S);function qe(){}function We(t){t.write(Be("")),t.close();var e=t.parentWindow.Object;return t=null,e}var Xe,Ve=g?Object.defineProperties:function(t,e){d(t);for(var n,r=a(e),o=re(e),i=o.length,c=0;c<i;)pt.f(t,n=o[c++],r[n]);return t},Ye=c("document","documentElement"),Ke=Lt("IE_PROTO"),Be=function(t){return"<script>"+t+"<\/script>"},Ue=function(){try{Xe=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ue="undefined"==typeof document||document.domain&&Xe?We(Xe):((e=s("iframe")).style.display="none",Ye.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write(Be("document.F=Object")),t.close(),t.F);for(var n=Xt.length;n--;)delete Ue.prototype[Xt[n]];return Ue()};Mt[Ke]=!0;S=Object.create||function(t,e){var n;return null!==t?(qe.prototype=d(t),n=new qe,qe.prototype=null,n[Ke]=t):n=Ue(),void 0===e?n:Ve(n,e)},Lt=j("unscopables"),j=Array.prototype;null==j[Lt]&&pt.f(j,Lt,{configurable:!0,value:S(null)}),xt({target:"Array",proto:!0},{fill:function(t){for(var e=O(this),n=kt(e),r=arguments.length,o=At(1<r?arguments[1]:void 0,n),r=2<r?arguments[2]:void 0,i=void 0===r?n:At(r,n);o<i;)e[o++]=t;return e}}),j[Lt].fill=!0;var $e,Je,Qe,Ze=h.Date,tn=p(Ze.prototype.getTime);function en(t){return t&&"function"==typeof t}function nn(){var t=[];return t.item=function(t){return this[t]||null},t.identifiedTouch=function(t){return this[t+1]||null},t}function rn(o){return function(t){var e,n,r;"mousedown"===t.type&&(Qe=!0),"mouseup"===t.type&&(Qe=!1),"mousemove"===t.type&&!Qe||(null==($e="mousedown"===t.type||!$e||$e&&!$e.dispatchEvent?t.target:$e).closest("[data-no-touch-simulate]")&&(e=o,n=t,(r=document.createEvent("Event")).initEvent(e,!0,!0),r.altKey=n.altKey,r.ctrlKey=n.ctrlKey,r.metaKey=n.metaKey,r.shiftKey=n.shiftKey,r.touches=cn(n),r.targetTouches=cn(n),r.changedTouches=on(n),$e.dispatchEvent(r)),"mouseup"===t.type&&($e=null))}}function on(t){var e=nn();return e.push(new Je($e,1,t,0,0)),e}function cn(t){return"mouseup"===t.type?nn():on(t)}function un(){window.addEventListener("mousedown",rn("touchstart"),!0),window.addEventListener("mousemove",rn("touchmove"),!0),window.addEventListener("mouseup",rn("touchend"),!0)}xt({target:"Date",stat:!0},{now:function(){return tn(new Ze)}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0}),function(){for(var o=0,t=["webkit","moz","ms","o"],e=0;e<4&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-o)),r=window.setTimeout(function(){return t(e+n)},n);return o=e+n,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),"undefined"!=typeof window&&(fn="ontouchstart"in window,document.createTouch||(document.createTouch=function(t,e,n,r,o,i,c){return new Je(e,n,{pageX:r,pageY:o,screenX:i,screenY:c,clientX:r-window.pageXOffset,clientY:o-window.pageYOffset},0,0)}),document.createTouchList||(document.createTouchList=function(){for(var t=nn(),e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length=arguments.length,t}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){var e=this;do{if(e.matches(t))return e}while(null!==(e=e.parentElement||e.parentNode)&&1===e.nodeType);return null}),Qe=!(Je=function(t,e,n,r,o){r=r||0,o=o||0,this.identifier=e,this.target=t,this.clientX=n.clientX+r,this.clientY=n.clientY+o,this.screenX=n.screenX+r,this.screenY=n.screenY+o,this.pageX=n.pageX+r,this.pageY=n.pageY+o}),un.multiTouchOffset=75,fn||un());function an(t){var e,n="";for(e in t)n+=";"+e+":"+t[e];return n}function ln(t,e,n,r,o){return{left:(t+n)*r+"px",top:(e+n)*o+"px"}}var sn={gridWidth:4,gridHeight:4,gridSizeWidth:100,gridSizeHeight:100,gridGap:20,showGridValue:!0,cls:{grid:"game-grid",gridTpl:"grid_"},grids:[{level:0,value:2,style:{"background-color":"rgb(238,228,218)",color:"black"}},{level:1,value:4,style:{"background-color":"rgb(238,224,200)",color:"rgb(124,115,106)"}},{level:2,value:8,style:{"background-color":"rgb(242,177,121)",color:"rgb(255,247,235)"}},{level:3,value:16,style:{"background-color":"rgb(245,149,99)",color:"rgb(255,247,235)"}},{level:4,value:32,style:{"background-color":"rgb(237,93,59)",color:"rgb(255,247,235)"}},{level:5,value:64,style:{"background-color":"rgb(236,206,112)",color:"rgb(255,247,235)"}},{level:6,value:128,style:{"background-color":"rgb(237,204,97)",color:"rgb(255,247,235)"}},{level:7,value:256,style:{"background-color":"rgb(236,200,80)",color:"rgb(255,247,235)"}},{level:8,value:512,style:{"background-color":"rgb(237,197,63)",color:"rgb(255,247,235)"}},{level:9,value:1024,style:{"background-color":"rgb(238,194,46)",color:"rgb(255,247,235)"}},{level:10,value:2048,style:{"background-color":"rgb(61,58,51)",color:"rgb(255,247,235)"}},{level:11,value:4096,style:{"background-color":"rgb(141 144 251)",color:"rgb(255,247,235)"}},{level:12,value:8192,style:{"background-color":"rgb(166 78 221)",color:"rgb(255,247,235)"}}],animateSpeed:300},fn=function(t,e){this.config=Object.assign({},sn,e||{}),this.el=t,this.watcher=[],this.slideTimestamp=0,this.state=Array(this.config.gridHeight*this.config.gridWidth).fill(null),this.__init()};return fn.prototype.move=function(t){var e,n,r,o,i,c,u,a=this,l=a.state,s=a.config,f=s.gridSizeWidth,d=s.gridSizeHeight,p=s.gridGap,h=s.gridWidth,g=s.gridHeight,y=a.slideTimestamp,v=Date.now();if(v-y<s.animateSpeed)return!1;switch(a.slideTimestamp=v,t){case"up":r=h-1,o=g-(n=1),i=e=0,c=-1;break;case"down":r=h-1,n=g-2,i=o=e=0,c=1;break;case"right":e=h-2,o=g-1,i=1,c=n=r=0;break;case"left":r=h-(e=1),o=g-1,i=-1,c=n=0}for(var m=e;Math.min(e,r)<=m&&m<=Math.max(e,r);r<e?m--:m++)for(var b=n;Math.min(n,o)<=b&&b<=Math.max(n,o);o<n?b--:b++){var w=document.querySelector("."+s.cls.gridTpl+m+"_"+b),S=l[h*b+m];if(null!=S){var T={x:m+i,y:b+c},O=l[h*T.y+T.x],j=0;if(0==e)if(o<n)for(;T.y<g-1&&null==O&&(T.y=T.y+1,O=l[h*T.y+T.x],++j<=Math.max(h,g)););else for(;0<T.y&&null==O&&(T.y=T.y-1,O=l[h*T.y+T.x],++j<=Math.max(h,g)););else if(r<e)for(;T.x<h-1&&null==O&&(T.x=T.x+1,O=l[h*T.y+T.x],++j<=Math.max(h,g)););else for(;0<T.x&&null==O&&(T.x=T.x-1,O=l[h*T.y+T.x],++j<=Math.max(h,g)););var x=ln(f,d,p,T.x,T.y);if(null==O)l[h*b+m]=null,l[h*T.y+T.x]=S,w.style.top=x.top,w.style.left=x.left,w.className=s.cls.grid+" "+S.class+" "+s.cls.gridTpl+T.x+"_"+T.y;else if(O.value!=S.value||O.justModified){if(O.value==S.value&&j<1)continue;if(0==e?T.y=o<n?T.y-1:T.y+1:T.x=r<e?T.x-1:T.x+1,T.x==m&&T.y==b)continue;x=ln(f,d,p,T.x,T.y),l[h*b+m]=null,w.className=s.cls.grid+" "+(l[h*T.y+T.x]=S).class+" "+s.cls.gridTpl+T.x+"_"+T.y,w.style.top=x.top,w.style.left=x.left}else{S=s.grids[S.level+1];S.justModified=!0,l[h*b+m]=null,l[h*T.y+T.x]=S,w.style.top=x.top,w.style.left=x.left,function(n,r,o,t){if(t=t||!1,!(void 0!==n&&n instanceof HTMLElement&&1===n.nodeType))throw"the argument of el is not HTMLElement";if(!en(o))throw"the argument of fn must be a function";n.addEventListener(r,function t(e){o.bind(e)(),~"animationend transitionend".indexOf(r)&&n.removeEventListener(r,t)}),t&&(n=null)}(w,"transitionend",function(n,r,o,i){return function(){n.style.display="none",n.className="";var t=document.querySelector("."+i.cls.gridTpl+r.x+"_"+r.y),e=o.style;e&&(e=an(e),t.style.cssText=t.style.cssText+e),t.className=i.cls.grid+" "+i.cls.gridTpl+r.x+"_"+r.y+" "+o.class+" ",i.showGridValue&&(t.innerText=o.value)}}(w,T,S,s))}u=!0}}for(var E=0;E<l.length;E++)null!=l[E]&&l[E].justModified&&delete l[E].justModified;a.watcher.forEach(function(t){t&&t.bind(a)({tag:"moved",state:l,self:a})}),u&&setTimeout(a.create.bind(a),s.animateSpeed)},fn.prototype.create=function(t,e,n){var r,o=this,i=o.state,c=o.config,u=c.grids,a=c.gridWidth,l=c.gridHeight,s=c.gridSizeWidth,f=c.gridSizeHeight,d=c.gridGap,p=(r=[],i.forEach(function(t,e){null==t&&r.push(e)}),r);if(!p.length)return!1;if(l*a-1<t||a<e||l<n)return"level or x or y out of the range";u=null!=t?u[t]:Math.random()<.5?u[1]:u[0],e={x:(n=null!=e&&null!=n?a*n+e:p[Math.floor(Math.random()*p.length)])%a,y:Math.floor(n/a)},f=ln(s,f,d,e.x,e.y),d=document.createElement("div"),f=Object.assign({position:"absolute",width:s+"px",height:s+"px",top:f.top,left:f.left},u.style||{});if(f&&(f=an(f),d.style.cssText=f),d.className=c.cls.grid+" "+u.class+" "+c.cls.gridTpl+e.x+"_"+e.y,c.showGridValue&&(d.innerText=u.value),this.el.appendChild(d),i[n]=u,o.watcher.forEach(function(t){t&&t.bind(o)({tag:"create",state:i,self:o})}),1==p.length){for(var h=!1,g=0;g<a&&!h;g++)for(var y=0;y<l&&!h;y++)0<g&&i[a*y+(g-1)].value==i[a*y+g].value&&(h=!0),g<a-1&&i[a*y+(g+1)].value==i[a*y+g].value&&(h=!0),0<y&&i[a*(y-1)+g].value==i[a*y+g].value&&(h=!0),y<a-1&&i[a*(y+1)+g].value==i[a*y+g].value&&(h=!0);if(!h)return console.log("canmove onFinish",i),c.onFinish&&c.onFinish(i),!1}return!0},fn.prototype.start=function(){var t=this.config;this.__init(),this.state=Array(t.gridHeight*t.gridWidth).fill(null),t.onReady&&t.onReady(),this.create()},fn.prototype.listen=function(t){if(!en(t))throw"the argument of fn must be a function";this.watcher.push(t)},fn.prototype.removeAllListener=function(){this.watcher=[]},fn.prototype.__init=function(){this.el.style.cssText="-webkit-user-select:none;user-select:none;",this.el.innerHTML=""},fn}();
